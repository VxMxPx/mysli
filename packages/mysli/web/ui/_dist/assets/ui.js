mysli="object"==typeof mysli?mysli:{},mysli.web="object"==typeof mysli.web?mysli.web:{},mysli.web.ui="object"==typeof mysli.web.ui?mysli.web.ui:{},mysli.web.ui.mixins="object"==typeof mysli.web.ui.mixins?mysli.web.ui.mixins:{},mysli.web.ui.mixins.event=function(){function trigger(event,params){if("undefined"==typeof this.events[event])throw new Error("Invalid event id: `"+event+"`");"object"!=typeof params&&(params=[]),params.push(this);var call,id=null;for(id in this.events[event])if(this.events[event].hasOwnProperty(id)){if(call=this.events[event][id],"function"!=typeof call)throw new Error("Invalid type of callback: `"+id+"`");call.apply(this,params)}}function connect(event,callback){var id="";if(event.indexOf("*")>0&&(id=event.split("*",2),event=id[0],id="*"+id[1]+"*"),"undefined"==typeof this.events[event])throw new Error("No such event available: `"+event+"`");return this.events_counter++,id=id+event+"--"+this.events_counter,this.events[event][id]=callback,id}function disconnect(id){var event=null;if("*"===id.substr(0,1)){id+="*";for(event in this.events)for(var eid in this.events[event])eid.substr(0,id.length)===id&&delete this.events[event][eid];return!0}return event=id.split("--",2)[0],"undefined"!=typeof this.events[event]?delete this.events[event][id]:!1}return function(){return this.events_counter=0,this.events={},this.trigger=trigger,this.connect=connect,this.disconnect=disconnect,this}}(),mysli.web.ui.mixins.widget=function(){function set_busy(state){if(state===!0){if(this.busy)return;this.trigger("busy-change",[state]),this.busy=new ui.overlay,this.busy.set_position(this.get_position()),this.busy.set_dimension(this.get_dimension()),this.connect("destroy*widget.overlay",this.busy.destroy.bind(this.busy)),this.connect("position-change*widget.overlay",function(__,position){this.busy.set_position(position)}),this.connect("size-change*widget.overlay",function(__,size){this.busy.set_size(size)}),this.busy.show()}else this.disconnect("*widget.overlay"),this.trigger("busy-change",[state]),this.busy=this.busy.destroy()}function get_busy(){return this.busy}function set_position(position){var element=this.elements[0];this.trigger("position-change",[position,!!element]),element&&element.offset(position)}function get_position(){return"object"==typeof this.elements[0]?this.elements[0].offset():void 0}function set_size(size){var element=this.elements[0];element&&(size.width&&element.css("width",size.width),size.height&&element.css("height",size.height)),this.trigger("size-change",[size,!!element])}function get_size(){var element=this.elements[0];return element?{width:element.outerWidth(),height:element.outerHeight()}:void 0}function set_id(id){if(this.id)throw new Error("You cannot change ID once it was set: `"+id+"`");if("undefined"!=typeof ids_pool[id])throw new Error("Item with such ID already exists: `"+id+"`");this.elements[0].attr("id",id),this.id=id,ids_pool[id]=this}function get_id(){return this.id}function destroy(){this.trigger("destroy"),this.id&&delete ids_pool[this.id];for(var event in this.events)this.events[event]={};for(var i=this.elements.length-1;i>=0;i--)this.elements[i].remove();return!1}var ui=mysli.web.ui,ids_pool={};return function(){return mysli.web.ui.mixins.event.call(this),this.events={"busy-change":{},"position-change":{},"size-change":{},added:{},removed:{},destroy:{}},this.elements=[],this.busy=!1,this.id=!1,this.parent=!1,this.set_busy=set_busy,this.get_busy=get_busy,this.set_position=set_position,this.get_position=get_position,this.set_size=set_size,this.get_size=get_size,this.set_id=set_id,this.get_id=get_id,this.destroy=destroy,this}}(),mysli.web.ui.mixins.container=function(){function add(element){element.parent=this,element.trigger("added",[this]),this.trigger("add",[element]);var id=this.container.elements.push(element)-1;element.get_id()&&(this.container.ids[element.get_id()]=id),element.connect("destroy*container.add",function(id){this.remove(id)}.bind(this,id)),element.elements[0].addClass("contained-element-n-"+id),this.elements[0].append(element.elements[0])}function remove(id){idn=get_internal_id(id);var element=this.get(idn);this.trigger("remove",[element]),element.trigger("removed",[this]),element.disconnect("*container.add"),element.parent=!1,delete this.container.elements[id],idn!==id&&delete this.container.ids[id],this.elements[0].find(".contained-element-n-"+idn).remove()}function get(id){return this.container.elements[get_internal_id(id)]}function get_internal_id(id){return"number"==typeof id?id:"undefined"!=typeof this.container.ids[id]?this.container.ids[id]:void 0}var ui=mysli.web.ui;return function(){return ui.mixins.widget.call(this),this.events.add={},this.events.remove={},this.container={elements:[],ids:{}},this.add=add,this.remove=remove,this.get=get,this}}(),mysli.web.ui.mixins.box=function(){var ui=mysli.web.ui,template='<div class="ui-box ui-widget"></div>';return function(){return ui.mixins.container.call(this),this.HORIZONTAL="orientation-horizontal",this.VERTICAL="orientation-vertical",this.elements.push($(template)),this.orientation=this.VERTICAL,this}}(),mysli.web.ui.mixins.root=function(){function set_size_to_window(){this.set_size({width:$(window).outerWidth(),height:$(window).outerHeight()})}function show(){this.parent.append(this.elements[0])}function set_track_resize(status,timeout){status?(timeout=timeout||500,$(window).on("resize",function(){this.resize_timer&&clearTimeout(this.resize_timer),this.resize_timer=setTimeout(set_size_to_window.bind(this),timeout)}.bind(this))):this.resize_timer&&clearTimeout(this.resize_timer)}var ui=mysli.web.ui,template='<div class="ui-root ui-widget"></div>';return function(){return ui.mixins.container.call(this),this.elements.push($(template)),this.parent=$("body"),this.resize_timer=!1,this.elements[0].css({top:0,left:0,position:"relative"}),this.parent.css("overflow","hidden"),set_size_to_window.call(this),this.show=show,this.set_track_resize=set_track_resize,this}}(),mysli.web.ui.mixins.button=function(){var ui=mysli.web.ui,template="<button></button>";return function(){return ui.mixins.widget.call(this),this.elements.push($(template)),this}}(),mysli.web.ui.button=function(){"use strict";var self=function(){mysli.web.ui.mixins.button.call(self.prototype)};return self}(),mysli.web.ui.panel_container=function(){"use strict";var ui=mysli.web.ui,self=function(){ui.mixins.root.call(self.prototype)};return self.prototype={constructor:self},self}();